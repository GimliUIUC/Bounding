function q = invKin(p,L1,L2)
% syms q1 q2 p1 p2 L1 L2
% p = [p1 p2];
% [Sq1, Sq2] = solve(-L1*cos(q1)-L2*cos(q1+q2)==p(1),-L1*sin(q1)-L2*sin(q1+q2)==p(2));
% q = [Sq1, Sq2]

p1 = p(1);  p2 = p(2);
q1 = -2*atan((2*L1*p2 + (L1^2*((- L1^2 + 2*L1*L2 - L2^2 + p1^2 + p2^2)*(L1^2 + 2*L1*L2 + L2^2 - p1^2 - p2^2))^(1/2))/(- L1^2 + 2*L1*L2 - L2^2 + p1^2 + p2^2) + (L2^2*((- L1^2 + 2*L1*L2 - L2^2 + p1^2 + p2^2)*(L1^2 + 2*L1*L2 + L2^2 - p1^2 - p2^2))^(1/2))/(- L1^2 + 2*L1*L2 - L2^2 + p1^2 + p2^2) - (p1^2*((- L1^2 + 2*L1*L2 - L2^2 + p1^2 + p2^2)*(L1^2 + 2*L1*L2 + L2^2 - p1^2 - p2^2))^(1/2))/(- L1^2 + 2*L1*L2 - L2^2 + p1^2 + p2^2) - (p2^2*((- L1^2 + 2*L1*L2 - L2^2 + p1^2 + p2^2)*(L1^2 + 2*L1*L2 + L2^2 - p1^2 - p2^2))^(1/2))/(- L1^2 + 2*L1*L2 - L2^2 + p1^2 + p2^2) - (2*L1*L2*((- L1^2 + 2*L1*L2 - L2^2 + p1^2 + p2^2)*(L1^2 + 2*L1*L2 + L2^2 - p1^2 - p2^2))^(1/2))/(- L1^2 + 2*L1*L2 - L2^2 + p1^2 + p2^2))/(L1^2 - 2*L1*p1 - L2^2 + p1^2 + p2^2)); 
q2 =  -2*atan(((- L1^2 + 2*L1*L2 - L2^2 + p1^2 + p2^2)*(L1^2 + 2*L1*L2 + L2^2 - p1^2 - p2^2))^(1/2)/(- L1^2 + 2*L1*L2 - L2^2 + p1^2 + p2^2));

% q1 = -2*atan((2*L1*p2 - (L1^2*((- L1^2 + 2*L1*L2 - L2^2 + p1^2 + p2^2)*(L1^2 + 2*L1*L2 + L2^2 - p1^2 - p2^2))^(1/2))/(- L1^2 + 2*L1*L2 - L2^2 + p1^2 + p2^2) - (L2^2*((- L1^2 + 2*L1*L2 - L2^2 + p1^2 + p2^2)*(L1^2 + 2*L1*L2 + L2^2 - p1^2 - p2^2))^(1/2))/(- L1^2 + 2*L1*L2 - L2^2 + p1^2 + p2^2) + (p1^2*((- L1^2 + 2*L1*L2 - L2^2 + p1^2 + p2^2)*(L1^2 + 2*L1*L2 + L2^2 - p1^2 - p2^2))^(1/2))/(- L1^2 + 2*L1*L2 - L2^2 + p1^2 + p2^2) + (p2^2*((- L1^2 + 2*L1*L2 - L2^2 + p1^2 + p2^2)*(L1^2 + 2*L1*L2 + L2^2 - p1^2 - p2^2))^(1/2))/(- L1^2 + 2*L1*L2 - L2^2 + p1^2 + p2^2) + (2*L1*L2*((- L1^2 + 2*L1*L2 - L2^2 + p1^2 + p2^2)*(L1^2 + 2*L1*L2 + L2^2 - p1^2 - p2^2))^(1/2))/(- L1^2 + 2*L1*L2 - L2^2 + p1^2 + p2^2))/(L1^2 - 2*L1*p1 - L2^2 + p1^2 + p2^2));
% q2 =  2*atan(((- L1^2 + 2*L1*L2 - L2^2 + p1^2 + p2^2)*(L1^2 + 2*L1*L2 + L2^2 - p1^2 - p2^2))^(1/2)/(- L1^2 + 2*L1*L2 - L2^2 + p1^2 + p2^2));

q = [q1 q2];

end